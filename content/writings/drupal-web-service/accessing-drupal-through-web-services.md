---
title: Accessing Drupal through Web Services
---
    <p>Regardless of the mechanism used for accessing your Drupal site through a web service, users will follow the same basic steps. First, they will call the <span class="geshifilter"><code class="text geshifilter-text">system.connect</code></span> method, which will return a session ID. At this point, the user may use the session id to access the site as an anonymous user. To gain elevated privileges, users can then call <span class="geshifilter"><code class="text geshifilter-text">user.login</code></span>, which requires a hash based on a given API key. At this point, the user will be given a new session id and Drupal will be aware of both the user and API key used. The user can now access different services as the authenticated user. Finally, for any mutable ("write") operations, the user will likely need to pass his/her API key through a hash for additional security.</p>
<h2>Accessing with Python : Ride the Snake</h2>
<p>We'll start accessing our Drupal site by using Python because it provides an interactive shell and strong support for xmlrpc proxies. Open a Python shell and try the following:<br />
<div class="geshifilter"><pre class="python geshifilter-python"><span class="kw1">import</span> <span class="kw3">xmlrpclib</span>
ursite = <span class="st0">&quot;http://example.com/services/xmlrpc&quot;</span>
proxy = <span class="kw3">xmlrpclib</span>.<span class="me1">Server</span><span class="br0">&#40;</span>ursite<span class="br0">&#41;</span></pre></div></p>
<p>This creates a proxy object which will represent your site, allowing us to call remote procedure calls as if they were native to the Python object. For example,<br />
<div class="geshifilter"><pre class="python geshifilter-python">proxy.<span class="me1">system</span>.<span class="me1">listMethods</span><span class="br0">&#40;</span><span class="br0">&#41;</span></pre></div> calls the "listMethods" method of the "system" service. This method returns the documentation for the web services API, which should include all of the methods you could see on the API Documentation page.<br />
<div class="geshifilter"><pre class="python geshifilter-python">proxy.<span class="me1">system</span>.<span class="me1">methodHelp</span><span class="br0">&#40;</span><span class="st0">'node.get'</span><span class="br0">&#41;</span>
<span class="co1"># 'Returns a node data.'</span></pre></div> gives the documentation for a given method (here, the "get" method of the "node" service.) This should tell users of your system what the different methods you provide do. If a user finds a particular method to be useful, he or she can then call<br />
<div class="geshifilter"><pre class="python geshifilter-python">proxy.<span class="me1">system</span>.<span class="me1">methodSignature</span><span class="br0">&#40;</span><span class="st0">'node.get'</span><span class="br0">&#41;</span>
<span class="co1"># ['struct', 'string', 'int', 'array']</span></pre></div> which will describe the method signature (i.e. the parameters that must be given) for a specific method. In this case, the initial parameter (the 'struct') is a Python-ism and can be safely ignored, the string is the session ID, the int is the node id, and the array is a list of fields to return. Relatively thorough documentation for these functions can be found on the in the Services API mentioned before. As you can see, though access to the site's proxy let us know each method's intents and signatures, as a site administrator, you will want to provide better documentation for your users.</p>
<p>Let's try accessing some data:<br />
<div class="geshifilter"><pre class="python geshifilter-python">connection = proxy.<span class="me1">system</span>.<span class="me1">connect</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
connection
<span class="co1"># {'sessid': '720e0e09a2bfe6d57292c3a95312da29', 'user': {'session': '', 'cache': 0, 'hostname': 'example.com', 'uid': 0, 'roles': {'1': 'anonymous user'}}}</span></pre></div> As mentioned before, the <span class="geshifilter"><code class="text geshifilter-text">system.connect</code></span> method returns a session id for an anonymous user. We will use that session id to perform the next tasks as the anonymous user, but let's go over some common stumbling blocks.<br />
<div class="geshifilter"><pre class="python geshifilter-python">proxy.<span class="me1">node</span>.<span class="me1">get</span><span class="br0">&#40;</span>connection<span class="br0">&#91;</span><span class="st0">'sessid'</span><span class="br0">&#93;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>
<span class="co1"># xmlrpclib.Fault: &lt;Fault -32602: 'Server error. Wrong number of method parameters.'&gt;</span></pre></div><br />
What happened? Look at the method signature again. Even though the final parameter ("fields") is marked as optional in the API documentation, you must give the method <em>something</em>. Let's try again, giving the default parameter: an empty list:<br />
<div class="geshifilter"><pre class="python geshifilter-python">proxy.<span class="me1">node</span>.<span class="me1">get</span><span class="br0">&#40;</span>connection<span class="br0">&#91;</span><span class="st0">'sessid'</span><span class="br0">&#93;</span>, <span class="nu0">1</span>, <span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>
<span class="co1"># xmlrpclib.Fault: &lt;Fault 1: 'Access denied.'&gt;)</span></pre></div><br />
This time, Drupal (not the xmlrpclib) is giving us an error because the anonymous user does not have access to node one on my site. Granting the anonymous user access to 'access content' will return a complete node object (represented as a Python dict):<br />
<div class="geshifilter"><pre class="python geshifilter-python"><span class="br0">&#123;</span><span class="st0">'comment'</span>: <span class="st0">'2'</span>, <span class="st0">'body'</span>: <span class="st0">''</span>, <span class="st0">'uid'</span>: <span class="st0">'3'</span>, <span class="st0">'vid'</span>: <span class="st0">'1890'</span>, <span class="st0">'taxonomy'</span>: <span class="br0">&#91;</span><span class="br0">&#93;</span>, <span class="st0">'sticky'</span>: <span class="st0">'0'</span>, <span class="st0">'revision_timestamp'</span>: <span class="st0">'1277237852'</span>, <span class="st0">'last_comment_name'</span>: <span class="st0">''</span>, <span class="st0">'log'</span>: <span class="st0">''</span>, <span class="st0">'title'</span>: <span class="st0">'My node title'</span>, <span class="st0">'body_value'</span>: <span class="st0">''</span>, <span class="st0">'tags'</span>: <span class="st0">''</span>, <span class="st0">'comment_count'</span>: <span class="st0">'0'</span>, <span class="st0">'revision_uid'</span>: <span class="st0">'3'</span>, <span class="st0">'moderate'</span>: <span class="st0">'0'</span>, <span class="st0">'type'</span>: <span class="st0">'page'</span>, <span class="st0">'status'</span>: <span class="st0">'1'</span>, <span class="st0">'picture'</span>: <span class="st0">''</span>, <span class="st0">'field_datetime'</span>: <span class="br0">&#91;</span><span class="br0">&#123;</span><span class="st0">'timezone'</span>: <span class="st0">'America/Chicago'</span>, <span class="st0">'date_type'</span>: <span class="st0">'datetime'</span>, <span class="st0">'value'</span>: <span class="st0">'2010-07-30 17:30:00'</span>, <span class="st0">'timezone_db'</span>: <span class="st0">'UTC'</span><span class="br0">&#125;</span><span class="br0">&#93;</span>, <span class="st0">'format'</span>: <span class="st0">'0'</span>, <span class="st0">'nid'</span>: <span class="st0">'3399'</span>, <span class="st0">'teaser'</span>: <span class="st0">''</span>, <span class="st0">'last_comment_timestamp'</span>: <span class="st0">'1277237852'</span>, <span class="st0">'promote'</span>: <span class="st0">'0'</span>, <span class="st0">'data'</span>: <span class="st0">'a:3:{s:13:&quot;form_build_id&quot;;s:37:&quot;form-160a8f61359c1398b591e102fe3afeed&quot;;s:14:&quot;picture_delete&quot;;s:0:&quot;&quot;;s:14:&quot;picture_upload&quot;;s:0:&quot;&quot;;}'</span>, <span class="st0">'tnid'</span>: <span class="st0">'0'</span>, <span class="st0">'translate'</span>: <span class="st0">'0'</span>, <span class="st0">'name'</span>: <span class="st0">'cmc'</span>, <span class="st0">'language'</span>: <span class="st0">''</span>, <span class="st0">'created'</span>: <span class="st0">'1277237852'</span>, <span class="st0">'changed'</span>: <span class="st0">'1277237852'</span>, <span class="st0">'field_goto_id'</span>: <span class="br0">&#91;</span><span class="br0">&#123;</span><span class="st0">'value'</span>: <span class="st0">'goto field value'</span><span class="br0">&#125;</span><span class="br0">&#93;</span><span class="br0">&#125;</span></pre></div></p>
    
- [&lt; Drupal's Services Module](../drupals-services-module)
- [PHP: Adding Some Structure &gt;](../php-adding-some-structure)
